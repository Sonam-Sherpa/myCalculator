<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Calculator Demo</title>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular.min.js"></script>  
    <!-- <script src="lib/angular/angular.min.js"></script>  doesn't work sometimes -->
    <script src="js/controller.js"></script>

<style>
table tr input{
    width: 208px;
    height: 60px;
    vertical-align: bottom;
    font-size: 20px;
    font-weight: bold;
    position: relative;
    padding-right: 3px;
}
table tr td button{
    width: 50px;
    height: 45px;
    font-size: 18px;
}
</style>

    
</head>

<body ng-app = "myApp">

<!--<div  ng-controller = "MyController">
     <h1>hi {{author.name}}</h1>
    <p>{{ author.title + ', ' + author.company }}</p> 
</div-->

<div ng-controller = "MyCalc">
    <h1>My {{author.project}}</h1>

    <table>
        <tr>
            <td colspan="4">
                <input type="text" style="text-align:right" id="txtDisplayNumber" value="0"> <br>
            </td>
        </tr>
        <tr>
                <td><button onclick="setOperator('%')" >%</button></td>
                <td><button onclick="" >x²</button></td>
                <td><button onclick="" >√</button></td>
                <td><button onclick="setOperator('/')" >÷</button></td>
        </tr>
        <tr>
                <td><button onclick="valueSet(7)" >7</button></td>
                <td><button onclick="valueSet(8)" >8</button></td>
                <td><button onclick="valueSet(9)" >9</button></td>
                <td><button onclick="setOperator('*')" >X</button></td>
        </tr>
        <tr>
                <td><button ng-click="i = 4" onclick="valueSet(4)" ng-init="button4 = '4'">{{ button4 }}</button></td>
                <td><button ng-click="i = 5" onclick="valueSet(5)" ng-init="button5 = '5'">{{ button5 }}</button></td>
                <td><button ng-click="i = 6" onclick="valueSet(6)" ng-init="button6 = '6'">{{ button6 }}</button></td>
                <td><button onclick="setOperator('-')" ng-init="button61 = '-'">{{ button61 }}</button></td>
        </tr>
        <tr>
            <td><button ng-click="i = 1" onclick="valueSet(1)" ng-init="button1 = '1'">{{ button1 }}</button></td>
            <td><button ng-click="i = 2" onclick="valueSet(2)" ng-init="button2 = '2'">{{ button2 }}</button></td>
            <td><button ng-click="i = 3" onclick="valueSet(3)" ng-init="button3 = '3'">{{ button3 }}</button></td>
            <td> <button onclick="setOperator('+')" ng-init="button11 = '+'">{{ button11 }}</button>                  
            </td>
        </tr>
        <tr>
            <td><button onclick="defaultState(0)">C</button></td>
            <td><button onclick="valueSet(0)">0</button></td>
            <td><button onclick="valueSet('.')">.</button></td>
            <td><button onclick="calculation()" ng-init="button12 = '='">{{ button12 }}</button></td>
        </tr>
    </table>

    <div >Total : <span id="total"></span></div>
    <hr>
    <hr>

</div>

<script>
    var firstNumber = secondNumber = result = 0;
    var strFirstVal = strSecondVal = "";
    var operatorAction = ""; // This will define the action

    var displayBar = document.getElementById("txtDisplayNumber"); //To show result
    displayBar.innerText = "0";
    console.log("start " + displayBar.value + " ?");


    function valueSet(value){
        //If there is no operator then firstNumber or secondNumber must continue.
        if(!operatorAction) //number1 must continue postpend
        {
            strFirstVal += value;
            firstNumber = parseInt(strFirstVal);
            console.log(strFirstVal + " firstNumber :" + firstNumber);
            displayBar.innerText = strFirstVal;
            return;
        }
        else{
            strSecondVal += value;
            secondNumber = parseInt(strSecondVal);
            console.log(strSecondVal + " secondNumber :" + secondNumber);
            displayBar.innerText = strSecondVal;
            return;
        }
        console.log("outside Return: unexpected ERROR");

    }

    function setOperator(operator){    
        if(operatorAction != "")  {
            calculation();
        }             
        operatorAction = operator;
        console.log("OperatorAction : " + operator);
        //Clear the displayBar
        //displayBar.innerText = "";
    }

    function calculation(){
        switch(operatorAction){
            case "+":
                addition();
                break;
            case "-":
                substraction();
                break;
            case "/":
                division();
                break;
            case "*":
                multiply();
                break;
            default:
                break;

        }
        operatorAction="";
    }

    function defaultState(){
        firstNumber = secondNumber = result = 0;
        strFirstVal = strSecondVal = "";
        operatorAction = ""; 
        displayBar.innerText = "0";
        console.log("default" + displayBar.value + " ?" );
    }

    function addition(){
        result = firstNumber+secondNumber;
        console.log(firstNumber+" + " + secondNumber + " = " + result );
        setUpForNewCalculation();
    }

    function substraction(){
        result = firstNumber-secondNumber;
        console.log(firstNumber+" + " + secondNumber + " = " + result );
        setUpForNewCalculation();
    }

    function division(){
        result = firstNumber/secondNumber;
        console.log(firstNumber+" + " + secondNumber + " = " + result );
        setUpForNewCalculation();
    }
    function multiply(){
        result = firstNumber*secondNumber;
        console.log(firstNumber+" x " + secondNumber + " = " + result );
        setUpForNewCalculation();
    }

    function setUpForNewCalculation(){
        displayBar.innerText = result;
        document.getElementById("total").innerHTML = result.toString(); 
        firstNumber = result;
        secondNumber=result=0;
        strSecondVal = "";
        operatorAction = "";
        console.log("Calculation done /n" + "first# " + firstNumber + "/nsecond# " + secondNumber + "/noperator :" + operatorAction + "/nresult:"+result );
    }



</script>


</body>
</html>